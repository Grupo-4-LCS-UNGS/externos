# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy Metabases
on:
  push:
    branches:
      - main 

permissions:
  checks: write
  contents: read
  pull-requests: write

jobs:
  setup:
    runs-on: potus
    steps:
      - uses: actions/checkout@v4

  
  deploy-server:
      runs-on: potus
      needs: setup
      steps:
        - uses: actions/checkout@v4
        - name: Quien soy
          run: whoami
        - name: Bajar servicio anterior Intento 1
          run: docker-compose -f docker-compose-metabase.yml -p g4-ext-metabase down
        - name: Bajar servicio anterior Intento 2
          run: docker-compose -f docker-compose-metabase.yml -p g4-ext-metabase down
        - name: Desplegar en LWS
          env:
            G2_DB_NAME: ${{ secrets.G2_DB_NAME }}
            G2_DB_USER: ${{ secrets.G2_DB_USER }}
            G2_DB_PASS: ${{ secrets.G2_DB_PASS }}
            G2_DB_HOST: ${{ secrets.G2_DB_HOST }}
            G3_DB_NAME: ${{ secrets.G3_DB_NAME }}
            G3_DB_USER: ${{ secrets.G3_DB_USER }}
            G3_DB_PASS: ${{ secrets.G3_DB_PASS }}
            G3_DB_HOST: ${{ secrets.G3_DB_HOST }}
          run: docker-compose -f docker-compose-metabase.yml -p g4-ext-metabase up -d
